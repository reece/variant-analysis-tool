#!/usr/bin/python -tt

import os
import sys
import warnings


sys.path.insert( 0, os.path.join(
	os.path.dirname(os.path.realpath(__file__)),
	'..', 'lib'
	))

import genomecommons.variantanalyzer
from genomecommons.exceptions import *


variants = [
	'AB026906.1:g.7872G>T',
	'AB026906.1:c.274G>T'
#
#	# following are from
#	# http://jmd.amjpathol.org/cgi/content/full/9/1/1/T1
#	'AJ574942.1:g.240G>T',
#	'AJ574943.1:g.261G>T',
#	'AJ574980.1:g.116G>A',
#	'AJ574983.1:g.179G>A',
#	'AJ574995.1:g.216G>A',
#	'AJ575003.1:g.305G>T',
#	'AY848832.1:g.40725C>T',
#
#	
#	'AY848832:g.40725C>T',				# expect unversioned ref seq warning
#
#	# from jt den dunnen slides:
#	'NM_012654.3:c.546A>T'				# this is a bogus reference sequence
	]

for v in variants:
	print '='*76, '\n*', v
	try:
		s = VariantAnalyzer(v).summary()
		print(s)
		print('%s = %s / %s / %s' % (s['vs'].varspec, s['vs'].accession, s['vs'].type, s['vs'].varlist))
		print('id:%s, gi:%s' % (s['gen']['id'], s['gen']['gi']))
		print('description:%s' % (s['gen']['description']))
		#print('features:%d (%s)'
		#	  % (len(r.features), ','.join([f.type for f in r.features])))
		print('%d -> %s -> %s' % (s['gen']['pos']+1,s['cds']['pos']+1,s['pro']['pos']+1))

		#seq = r.seq
		#print vs.varlist[0], pos, seq[pos-1]
		# TODO assert that subst na == seq[pos-1] 

	except (GCError,GCWarning) as e:
		warnings.warn(str(e))
		pass
	except:
		raise
